---
title: Exchange 2013 のバックアップ操作の種類
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
ms.localizationpriority: medium
ms.assetid: 70510902-9583-4177-be3d-afbf757a1ec0
description: Exchange 2013 ストア データベースで実行できるバックアップの種類 (完全バックアップ、コピー バックアップ、増分バックアップ、差分バックアップ) について説明します。
ms.openlocfilehash: 79fcdaa40409ee7cac4df44711c1551946b85ca1
ms.sourcegitcommit: 54f6cd5a704b36b76d110ee53a6d6c1c3e15f5a9
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/24/2021
ms.locfileid: "59520256"
---
# <a name="types-of-backup-operations-for-exchange-2013"></a>Exchange 2013 のバックアップ操作の種類

Exchange 2013 ストア データベースで実行できるバックアップの種類 (完全バックアップ、コピー バックアップ、増分バックアップ、差分バックアップ) について説明します。
  
**製品:** Exchange Server 2013 
  
この記事では、2013 データベースで実行できるさまざまな種類のバックアップExchange Server、それらのバックアップがデータベース ファイルに与える影響について説明します。 
  
ボリューム シャドウ コピー サービス (VSS) と Exchange ライターを使用するバックアップと復元アプリケーションでは、次の表に示す種類のバックアップを実行できます。
  
**表 1.バックアップ操作の種類**

|**バックアップの種類**|**説明**|
|:-----|:-----|
|[完全バックアップ](types-of-backup-operations-for-exchange-2013.md#bk_FullBackups) <br/> |データベース (.edb)、トランザクション ログ ( .log)、チェックポイント ファイル ( .chk) をバックアップし、特定のデータベースのトランザクション ログ \* \* \* を切り捨てる。  <br/> |
|[コピー バックアップ](types-of-backup-operations-for-exchange-2013.md#bk_CopyBackups) <br/> |データベース、トランザクション ログ、およびチェックポイント ファイルをバックアップします。コピー バックアップでは、データベースのトランザクション ログは切り詰められません。  <br/> |
|[増分バックアップ](types-of-backup-operations-for-exchange-2013.md#bk_IncrementalBackups) <br/> |最後の完全バックアップまたは増分バックアップ以降に行われた変更を記録するトランザクション ログをバックアップして、トランザクション ログを切り詰めます。  <br/> |
|[差分バックアップ](types-of-backup-operations-for-exchange-2013.md#bk_DifferentialBackups) <br/> |最後の完全バックアップまたは増分バックアップ以降に行われた変更を記録するトランザクション ログをバックアップしますが、トランザクション ログは切り詰めません。  <br/> |
   
2013 データベース内のデータベース ファイルとトランザクション ログは、Exchange作成者によって定義されたコンポーネントまたはデータベース ファイルExchange表します。 これにより、バックアップおよび復元アプリケーションは、バックアップ操作中に 2013 データベース内のExchangeを表示できます。 ただし、バックアップ アプリケーションは個々のデータベース コンポーネントをバックアップできません。データベース全体のみをバックアップできます。 
  
Exchange ライターは、データベース コンポーネントの論理パスを標準化します。このパスは Exchange ライターのメタデータで指定されています。必要に応じて、Exchange ライターはバックアップと復元のアプリケーションに論理パスを返します。
  
このExchangeは、次の形式の論理パスを提供します。 
  
 `logicalPath = "Exchange Server\Microsoft Information Store\<Server name>"`
  
サーバー コンポーネントとデータベース コンポーネントはファイル グループのコンポーネントですが、関連ファイルはありません。これらには、個々のファイルを指定するサブコンポーネントがあります。データベースには、Logs という名前のログ コンポーネントが 1 つだけ含まれています。個々のデータベース コンポーネントのコンポーネント名は、文字列で表示されるデータベースの GUID です。  
  
このExchangeは、VSS フレームワークのガイドラインに基づいて、バックアップできるデータベースのみを一覧表示します。 Exchange 2013 回復データベースとしてマウントされているデータベース、およびマウントされていないデータベースはバックアップできないので、Exchange ライターのメタデータには一覧表示されません。
  
次の図に、Exchange ライターのバックアップ プロセスを示します。 
  
**図 1バックアップ プロセスのイベントのシーケンス**

![バックアップ プロセスのイベント シーケンスを示す図。シーケンスは、Exchange ストアの起動から始まり、Exchange ライター、VSS、およびクライアント アプリケーションの間での多くのステップが続きます。](media/VSS_StoreWriterBackup.gif)
  
## <a name="full-backups"></a>完全バックアップ
<a name="bk_FullBackups"> </a>

Exchange データベースの完全バックアップでは、データベース ファイル、トランザクション ログ、およびチェックポイント ファイルのコピーを作成して格納する必要があります。 2013 Exchange 1 つのデータベースには、専用のトランザクション ログ ファイルのセットが 1 つ含まれます。
  
データベースのバックアップが終了した後に、ディスク上のトランザクション ログ ファイルが切り詰められます。これで、バックアップ後に実行したデータベースの変更のみが維持されるようになります。このプロセスの間、Exchange ライターは、データベースが直近のチェックポイントまでのすべての変更を含んだ整合状態で現在バックアップされている、という前提に基づいて、チェックポイントまですべてのログ エントリを削除します。  
  
バックアップ中のデータベースがバックアップ操作中にマウント解除された場合、Exchange 2013 はトランザクション ログを切り詰め、結果は完全バックアップ操作ではなく、コピー バックアップ操作と同等になります。 
  
完全バックアップが完了すると、マウントされているアクティブなデータベースのヘッダーが、現在のバックアップ情報を使用して更新されます。レプリケートされた展開では、この情報はトランザクション ログ ファイルにコミットされ、データベースの別の DAG のコピーにレプリケートされます。データベース コピーのヘッダーは、このトランザクション ログ ファイルがデータベース コピーで再生されるように更新されます。
  
完全シャドウ コピー バックアップは、増分シャドウ コピー バックアップまたは差分シャドウ コピー バックアップを実行するために必要です。完全バックアップは、任意のコピー (シャドウ コピー バックアップに限る) から取得できます。
  
完全バックアップは、次に示すシナリオで使用できます。
  
- データベースが破損または消失したが、ディスク上のトランザクション ログ ファイルはそのまま残っている。このシナリオでは、影響を受けるデータベース ファイルを完全バックアップから復元し、ディスク上に残っているトランザクション ログを再生することにより回復します。  
    
- ディスク上のデータベース ファイルとトランザクション ログ ファイルが消失している。このシナリオでは、完全バックアップの際にバックアップされたトランザクション ログ ファイルがデータベースと共に復元されます。
    
2013 Exchangeでは、完全バックアップ セットから該当するデータベースを復元することなく、ログを復元できます。 このオプションは、以前の完全バックアップを復元し、最新の完全バックアップからのトランザクション ログ ファイルを結合して、ロール フォワードを可能にします。
  
VSS [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx)の列挙体が VSS_BT_FULL ライターがバックアップを **実行** Exchangeに設定されている場合、次のコンポーネントがバックアップに含まれます。 
  
- 論理パスが \Microsoft Information Store Exchange Serverサーバー名<\\ GUID<\> \\ データベース\> 
    
- サーバー名とデータベース GUID の論理パスExchange Server\Microsoft Information Store \\<ログ \> \\<ファイル\> 
    
## <a name="copy-backups"></a>コピー バックアップ
<a name="bk_CopyBackups"> </a>

Exchange データベースのコピー バックアップでは、完全バックアップに含まれる要素と同じ要素を作成して格納する必要があります。ただし、完全バックアップとは異なり、ディスク上のトランザクション ログ ファイルはバックアップが完了しても切り詰められません。コピー バックアップは、データ復旧を目的としたものではありません。その代わりに、コピーバックアップでは、テストや問題の診断、レプリカのシード処理に使用するデータのイメージを提供します。
  
たとえば、Exchange ストアで問題が発生している Exchange 2013 管理者は、実稼働システムに影響を与えることなく、テスト環境で使用するコピー バックアップを作成できます。 コピー バックアップは、通常のバックアップ スケジュールには影響を与えはありません。ただし、コピー バックアップは Exchange ストアも進行中のバックアップ状態に置くので、コピー バックアップが完了または中止されるまで、他のスケジュールされたバックアップの進行をブロックします。 
  
VSS の [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) 列挙体が [VSS_BT_COPY] に設定されている場合、次 **の** コンポーネントがコピー バックアップに含まれます。 
  
- 論理パスが \Microsoft Information Store Exchange Serverサーバー名<\\ GUID<\> \\ データベース\> 
    
- 論理パスを持つログ ファイル Exchange Server\Microsoft Information Store<サーバー名 \\<\> \\ GUID\>
    
## <a name="incremental-backups"></a>増分バックアップ
<a name="bk_IncrementalBackups"> </a>

2013 データベースの増分バックアップExchange、最後の完全バックアップまたは増分バックアップ以降に発生したデータベースへの変更を保存します。 すべてのデータベース ファイルとログ ファイルがシステムに復元されると、前回の増分バックアップの時点の状態に回復できます。 増分バックアップに格納されているデータには、現在の時刻までのトランザクション ログ ファイルのみが含まれています。 
  
バックアップが完了すると、Exchange サーバーはログ ファイルを切り詰め、データベース ヘッダー内にあるバックアップの時間をマークします。増分バックアップを使用してデータベースを回復するには、復元されるデータ セットが少なくとも 2 つ (直前の完全バックアップと、その後のすべての増分バックアップ) 必要です。増分バックアップの使用には、個々のバックアップが完全バックアップよりはるかに小さいことや、個々の増分バックアップが差分バックアップより小さくなることが多いという利点があります。  
  
増分バックアップの使用には、完全バックアップと完全バックアップの間に何度も増分バックアップを行うと、Exchange ストアの回復によって多くの増分バックアップを引き起こす可能性があるという欠点もあります。Exchange では、増分の変更の開始点を確立するための、以前の完全バックアップがない場合、増分バックアップを実行できません。  
  
DAG コピーの場所から完全バックアップを作成した後に、アクティブな場所からの増分バックアップを実行し、その逆を実行できます。 注意すべき 1 つの制限は、最後のバックアップ状態がアクティブ なデータベースのヘッダーに保持され、データベース ヘッダーへの変更が DAG 展開の他のすべてのトランザクション ログと同様にトランザクション ログに書き込まれたり、レプリケートされ、コピー データベースの場所で再生される点です。 バックアップと復元は相互運用可能なので、バックアップ アプリケーションは、ノードがアクティブかパッシブかに関係なく、特定の DAG ノード上でバックアップを排他的に実行したり、パッシブ ノードからバックアップを実行したり、アクティブ ノードから排他的にバックアップを実行したりするための機能を提供できます。
  
VSS の [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) 列挙体が VSS_BT_INCREMENTAL **に設定** されている場合、次のコンポーネントが増分バックアップに含まれます。 
  
- 論理パスが \Microsoft Information Store Exchange Serverサーバー名<\\ GUID<\> \\ データベース\> 
    
- サーバー名とデータベース GUID の論理パスExchange Server\Microsoft Information Store \\<ログ \> \\<ファイル\>
    
## <a name="differential-backups"></a>差分バックアップ
<a name="bk_DifferentialBackups"> </a>

2013 データベースの差分バックアップExchange、前回の完全バックアップまたは増分バックアップ以降に発生したデータベースへの変更を保存します。 データベース ファイルとログ ファイルがシステムによって復元されると、前回の差分バックアップの時点の状態に回復できます。 
  
差分バックアップに格納されているデータには、現在のチェックポイントまでのトランザクション ログ ファイルのみが含まれています。差分バックアップでは、ログ ファイルを削除または変更しないでください。または、データベースのヘッダーを変更しないでください。データベースの回復に差分バックアップを使用する場合は、2 つのデータ セット (直前の完全バックアップと、その後に最新の差分バックアップ) のみを復元する必要があります。  
  
差分バックアップの使用には、完全バックアップが実行されるまで差分バックアップは各バックアップ内のバックアップされたデータを重複させる、という欠点があります。　完全バックアップと完全バックアップの間に何度も差分バックアップを行うと、必要な記憶域の量は、同じ回数の増分バックアップに必要な量を超える可能性があります。Exchange では、異なるバックアップの変更の開始点を確立するための完全バックアップまたは増分バックアップがない場合、差分バックアップを実行できません。
  
コピーの場所から取得した完全バックアップに続いて、アクティブな場所とその逆の場所からの差分バックアップを実行できます。最後のバックアップの状態がアクティブなデータベースのヘッダーに維持されていること、データベースのヘッダーに対する変更がトランザクション ログに書き込まれ、レプリケートされ、DAG 展開の他のすべてのトランザクション ログと同様にコピー データベースの場所で再生されること、などの制限に留意してください。バックアップと復元は相互運用されるため、バックアップ アプリケーションでは特定の DAG ノード上で排他的にすべてのバックアップを実行する機能を提供します。これは、ノードがアクティブでもパッシブでも関係ありません。また、パッシブ ノードからの排他的なバックアップの実行でもアクティブ ノードからの排他的なバックアップの実行でも関係ありません。
  
VSS の [VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx) 列挙体が VSS_BT_DIFFERENTIALに設定 **されている** 場合、次のコンポーネントが差分バックアップに含まれます。 
  
- 論理パスが \Microsoft Information Store Exchange Serverサーバー名<\\ GUID<\> \\ データベース\> 
    
- サーバー名とデータベース GUID の論理パスExchange Server\Microsoft Information Store \\<ログ \> \\<ファイル\>
    
## <a name="see-also"></a>関連項目
<a name="bk_AdditionalResources"> </a>

- [Exchange 2013 のバックアップと復元アプリケーションの作成](build-backup-and-restore-applications-for-exchange-2013.md)
    
- [Exchange 2013 のバックアップと復元の概念](backup-and-restore-concepts-for-exchange-2013.md)
    
- [Exchange 2013 のデータベースを復元する](restoring-exchange-2013-databases.md)
    
- [2013 年に CHKSGFILES API を使用してバックアップExchangeする](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
    
- [2013 年に Eseutil ツールを使用してバックアップの整合性Exchangeする](how-to-validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013.md)
    

